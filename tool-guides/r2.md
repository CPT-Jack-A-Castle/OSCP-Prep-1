# r2

## General Information 
````
rabin2 -I filename
````
- Output 
````
$ rabin2 -I megabeets_0x1
arch     x86
baddr    0x8048000
binsz    6220
bintype  elf
bits     32
canary   false
class    ELF32
compiler GCC: (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609
crypto   false
endian   little
havecode true
intrp    /lib/ld-linux.so.2
laddr    0x0
lang     c
linenum  true
lsyms    true
machine  Intel 80386
maxopsz  16
minopsz  1
nx       false
os       linux
pcalign  0
pic      false
relocs   true
relro    partial
rpath    NONE
sanitiz  false
static   false
stripped false
subsys   linux
va       true
`````

## Run Program with R2
````
r2 ./filename
````
## Find Entrypoints
````
[0x08048370]> ie
[Entrypoints]
vaddr=0x08048370 paddr=0x00000370 haddr=0x00000018 hvaddr=0x08048018 type=program 1 entrypoints
````
- `ie` stands for info entrypoints

## Help 
- If you know the general flag you want to use i.e. `i` for info you can append a `?`
````
i?
````
- This will show you all the help available to append to the `i` flag.

## Analysis 
- r2 does not analyze the file by default, you need to specify the `a` flag
- To have r2 analyze the file issue `aa` or analyse all, or `aaa`
````
[0x08048370]> aaa
[x] Analyze all flags starting with sym. and entry0 (aa)
[x] Analyze function calls (aac)
[x] Analyze len bytes of instructions for references (aar)
[x] Check for objc references
[x] Check for vtables
[x] Type matching analysis for all functions (aaft)
[x] Propagate noreturn information
[x] Use -AA or aaaa to perform additional experimental analysis.
````
- Can also have r2 analyze the file at start up with 
````
r2 -A filename
````
## Flag Space 
- After analysis radare2 associates names to interesting offsets in the file such as `sections, functions, symbols, strings`.
- All are called `flags`
- Choose a flag space using `fs flagspace` and print the flags it contains with `f`.
- Can pass multiple commands with semi colon i.e. `cmd1;cmd2;cmd3`
````
fs imports; f
[0x08048370]> fs imports; f
0x00000000 16 loc.imp.__gmon_start
0x08048320 6 sym.imp.strcmp
0x08048330 6 sym.imp.strcpy
0x08048340 6 sym.imp.puts
0x08048350 6 sym.imp.__libc_start_main
````
- Can see the strcmp, strcpy, puts etc.

- We can also list the strings flagspace 
````
[0x08048370]> fs strings 
[0x08048370]> f
0x08048700 21 str..::_Megabeets_::.
0x08048715 23 str.Think_you_can_make_it
0x0804872c 10 str.Success
0x08048736 22 str.Nop__Wrong_argument.
````
## Strings
- Lets look at the strings 
- `iz` - List the strings in data sections 
- `izz` Search for strings in the whole binary 
````
[0x08048370]> iz
[Strings]
nth paddr      vaddr      len size section type  string
―――――――――――――――――――――――――――――――――――――――――――――――――――――――
0   0x00000700 0x08048700 20  21   .rodata ascii \n  .:: Megabeets ::.
1   0x00000715 0x08048715 22  23   .rodata ascii Think you can make it?
2   0x0000072c 0x0804872c 9   10   .rodata ascii Success!\n
3   0x00000736 0x08048736 21  22   .rodata ascii Nop, Wrong argument.\n
````
### axt Analyse X-refs to 
- `axt` stands for analyse x-refs to 
- Finds data or code references to this specific address 
- `@@` is like a for each iterator sign used to repeat a command over a list of offsets 
- `str.*` is a wildcard for all flags that start with `str.` (our strings)
- This helps to list the function name, where they are used and the reference instruction in addition to the strings 
- Select the correct strings flagspace (default is `'fs *'`

## Seeking 








### All Credit:
https://www.megabeets.net/a-journey-into-radare-2-part-1/






